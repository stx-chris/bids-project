---
title: BIDS Projekt
subtitle: Gruppe 3
author:
  - Constanze Leichtweiß
  - Ivanna Marchesini
  - Christoph Kovacs
  - Enrico Wondra
#execute:
#  cache: false
---

```{r}
#| cache: false
load("../session.RData")
library(UpSetR)
```

# Einführung

## Sample Vorbereitung
::: aside
Ivanna
:::

![](../images/intro1.jpg){.nostretch fig-align="center" width="700px"}

## RNA-Seq Pipeline
![](../images/intro2.jpg){.nostretch fig-align="center" width="100%"}

## Wirkungsweise
::: aside
Enrico
:::

```{mermaid}
%%| fig-align: center
flowchart TD
    RTK["Rezeptor-Tyrosinkinase (zB EGFR, VEGFR)"]
    RAS["RAS (GTPase)"]
    RAF["RAF-Kinase (inkl. BRAF)"]
    MEK["MEK1/2-Kinase"]
    ERK["ERK1/2-Kinase"]
    PRO["Zellproliferation und Überleben"]

    RTK --> RAS --> RAF --> MEK --> ERK --> PRO

    SORA["**Sorafenib** (RAF-Hemmer)"] -.-> RAF
    TRAM["**Trametinib** (MEK-Hemmer)"] -.-> MEK

    style SORA fill:yellow,stroke:orange,stroke-width:2px
    style TRAM fill:aqua,stroke:blue,stroke-width:2px
```

# Analyse

## Ziel:<br>Unterschiede in der Genexpression finden

::: aside
Constanze
:::

-   Aufstellen einer Nullhypothese H0: **kein Unterschied**
-   Gegenhypothese: Es gibt einen **Unterschied**
-   Negative Binominalverteilung zur Modellierung der Counts (Varianz besser abbildbar)
-   Fold Change = Wert Bedingung (Sora) / Wert Bedingung (DMSO)
-   Logarithmierte Fold Change hat Vorteile beim Rechnen (Linear / Additiv)
-   Ergänzung zum log2FoldChange?

## Vorbereitung

::: aside
Constanze
:::

-   Erstellen einer Count-Matrix
-   Filtern der Daten

```{r}
#| eval: false
#| echo: true
# Filter: min. 2 Spalten mit je mehr als 10 Counts benötigt

keep <- rowSums(counts(dds) >= 10) >= 2
sum(keep) # Behalte 18,198 Records für die Analyse (31%)
sum(dim(count_matrix)[1]-sum(keep)) # Verwerfe 39,575 Records (69%)
```

-   Erstellen des DeSeq2-Objekts
-   Transformieren und Normalisieren der Beobachtungen

## Count-Daten

::: aside
Constanze
:::

::: panel-tabset
### Nur transformiert

```{r}
plot_counts_trans
```

### Transformiert und normalisiert

```{r}
plot_counts_normtrans
```
:::

# Explorative Analyse

## Strukturfindung

::: aside
Chris
:::

:::: panel-tabset
### Scree Plot

**Optimale Anzahl Komponenten für PCA**

::: no-stretch
```{r}
plot_scree
```

-   Nur Top 500 Gene miteinbezogen
-   2-3 Komponenten optimal
:::

### 2D-PCA

```{r}
plot_pca_2d
```

-   Klare Separierbarkeit entlang PC1
-   Stabile Kontrollgruppe
-   Sora deutlich von DMSO unterschieden
-   Tram mit In-Sample Unterschieden (PC2)
-   Problem: Misst nur linearen Zusammenhang

### 3D-PCA

```{r}
plot_pca_3d
```

-   PC3 erklärt nur knapp 7% der Gesamtvarianz
-   Keine bessere Separabilität

### t-SNA

**t-distributed Stochastic Neighbor Embedding**

```{r}
plot_tsna
```

-   Misst lokalen nicht-linearen Zusammenhang
-   Deutliche Cluster der drei Treatments
-   Trametinib kohärenter als bei PCA

### UMAP

**Uniform Manifold Approximation and Projection**

```{r}
plot_umap
```

-   Misst lokalen und globalen Zusammenhang
-   "Gradientenstruktur" DMSO → Tram → Sora
-   Problem: Zu wenige Samples
::::

# Differenzielle Expressions Analyse (DEG)

## Signifikant regulierte Gene

::: aside
Constanze
:::

::: no-stretch
```{r}
plot_deg
```
:::

-   Sorafenib ca. 3500 hoch- und runterregulierte Gene
-   Trametinib nur ca. 800

## Gemeinsam regulierte Gene

::: aside
Constanze
:::

::::: panel-tabset
### Hochreguliert

::: no-stretch
```{r}
upset(fromList(up_list), 
      order.by = "freq",
      mainbar.y.label = "Gemeinsame hochregulierte Gene",
      sets.x.label = "Gene pro Medikament",
      text.scale = c(2, 2, 2, 2, 2, 2))
```
:::

### Herunterreguliert

::: no-stretch
```{r}
upset(fromList(down_list), 
      order.by = "freq",
      mainbar.y.label = "Gemeinsame herunterregulierte Gene",
      sets.x.label = "Gene pro Medikament",
      text.scale = c(2, 2, 2, 2, 2, 2))
```
:::
:::::

## Signifikanz einzelner Gene

::: aside
Chris
:::

::: panel-tabset
### Sorafenib

```{r}
plot_volcano_sora
```

-   ↑↑↑ CDX2, BMF, PCK1, CDKN1B<br>**Zellzyklushemmung, Apoptose, Differenzierung**
-   ↓↓↓ TNS4, MYC, FOSL1, SPRY4, IER3<br>**Tumorwachstumsmechanismen**

### Trametinib

```{r}
plot_volcano_tram
```

-   ↑↑↑ BMF, CYP1A, ASCL2<br>**Zellulärer Stress bzw. Schadensantworten**
-   ↓↓↓ TNS4, IER3, FOSL1<br>**MAPK-assoziierte Proliferation, Stressantworten und zelluläre Bewegung**
:::

# Gene Set Enrichment (GSE) and KEGG Pathway Analyse

## Signalwege, hochreguliert

::: aside
Ivanna, Enrico
:::

::: panel-tabset
### Top 10

```{r}
gsea_plot_up
```

### Dot-Plot

```{r}
gsea_dotplot_up
```
:::

## Signalwege, herunterreguliert

::: aside
Ivanna, Enrico
:::

::: panel-tabset
### Top 10

```{r}
gsea_plot_down
```

### Dot-Plot

```{r}
gsea_dotplot_down
```
:::


## Gene Ontology Analyse

::: aside
Ivanna, Enrico
:::

:::: panel-tabset

### Sora Up
```{r}
plot_go_sora_up
```

### Sora Down
```{r}
plot_go_sora_down
```

### Tram Up
```{r}
plot_go_tram_up
```

### Tram Down
```{r}
plot_go_tram_down
```
:::: 

# Ideen

##

::: aside
Ivanna
:::

- Vorhersage der Drug Response von Tumoren anhand integrierter genomischer Profile mittels Deep Neural Networks<br>**→ Trainieren von Modellen**
- Führe die DEG-Analyse getrennt für Mutanten- und Wildtyp-Gruppen durch.<br>**→ Gibt es Unterschiede?**
- Spielt **DNA-Methylierung** eine Rolle?


## Code Repositories

- <a href="https://github.com/CLeichtweiss/Systembiologie2025" data-preview-link>Github Constanze Leichtweiß</a>
- <a href="https://github.com/ivimarchesini/bids-rna-sequencing" data-preview-link>Github Ivanna Marchesini</a>
- <a href="https://github.com/stx-chris/bids-project" data-preview-link>Github Christoph Kovacs</a>
- <a href="https://github.com/en-wo/Systembiologie2025" data-preview-link>Github Enrico Wondra</a>


## Referenzen

::: aside
- Qi GX, Zhao RX, Gao C, Ma ZY, Wang S, Xu J. Recent advances and challenges in colorectal cancer: From molecular research to treatment. World J Gastroenterol. 2025 Jun 7;31(21):106964. doi: 10.3748/wjg.v31.i21.106964. PMID: 40538516; PMCID: PMC12175868.
- Dobin A, Davis CA, Schlesinger F, Drenkow J, Zaleski C, Jha S, Batut P, Chaisson M, Gingeras TR. STAR: ultrafast universal RNA-seq aligner. Bioinformatics. 2013 Jan 1;29(1):15-21. doi: 10.1093/bioinformatics/bts635. Epub 2012 Oct 25. PMID: 23104886; PMCID: PMC3530905.
- Li J, Varghese RS, Ressom HW. RNA-Seq Data Analysis. Methods Mol Biol. 2024;2822:263-290. doi: 10.1007/978-1-0716-3918-4_18. PMID: 38907924; PMCID: PMC12125953.
- Koch CM, Chiu SF, Akbarpour M, Bharat A, Ridge KM, Bartom ET, Winter DR. A Beginner's Guide to Analysis of RNA Sequencing Data. Am J Respir Cell Mol Biol. 2018 Aug;59(2):145-157. doi: 10.1165/rcmb.2017-0430TR. PMID: 29624415; PMCID: PMC6096346.
- Wall P, Ideker T. Representing mutations for predicting cancer drug response. Bioinformatics. 2024 Jun 28;40(Suppl 1):i160-i168. doi: 10.1093/bioinformatics/btae209. PMID: 38940147; PMCID: PMC11256944.
:::